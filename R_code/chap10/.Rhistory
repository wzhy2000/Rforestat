area3 = 182,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 86,              # 集合 1 和 集合 3 的交集大小
n23 = 84,              # 集合 2 和 集合 3 的交集大小
n123 = 44,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 430,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 163,              # 集合 1 和 集合 3 的交集大小
n23 = 144,              # 集合 2 和 集合 3 的交集大小
n123 =78,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 430,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 163,              # 集合 1 和 集合 3 的交集大小
n23 = 144,              # 集合 2 和 集合 3 的交集大小
n123 =78,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 430,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 138,              # 集合 1 和 集合 3 的交集大小
n23 = 104,              # 集合 2 和 集合 3 的交集大小
n123 =56,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 326,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 138,              # 集合 1 和 集合 3 的交集大小
n23 = 104,              # 集合 2 和 集合 3 的交集大小
n123 =56,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 389,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 155,              # 集合 1 和 集合 3 的交集大小
n23 = 127,              # 集合 2 和 集合 3 的交集大小
n123 =70,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 430,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 217,              # 集合 1 和 集合 3 的交集大小
n23 = 173,              # 集合 2 和 集合 3 的交集大小
n123 =118,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 430,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 217,              # 集合 1 和 集合 3 的交集大小
n23 = 173,              # 集合 2 和 集合 3 的交集大小
n123 =60,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 664,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 267,              # 集合 1 和 集合 3 的交集大小
n23 = 294,              # 集合 2 和 集合 3 的交集大小
n123 =107,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 664,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 267,              # 集合 1 和 集合 3 的交集大小
n23 = 294,              # 集合 2 和 集合 3 的交集大小
n123 =107,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 531,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 298,              # 集合 1 和 集合 3 的交集大小
n23 = 281,              # 集合 2 和 集合 3 的交集大小
n123 =105,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 531,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 298,              # 集合 1 和 集合 3 的交集大小
n23 = 281,              # 集合 2 和 集合 3 的交集大小
n123 =105,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 419,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 205,              # 集合 1 和 集合 3 的交集大小
n23 = 166,              # 集合 2 和 集合 3 的交集大小
n123 =58,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 419,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 205,              # 集合 1 和 集合 3 的交集大小
n23 = 166,              # 集合 2 和 集合 3 的交集大小
n123 =58,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 419,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 174,              # 集合 1 和 集合 3 的交集大小
n23 = 160,              # 集合 2 和 集合 3 的交集大小
n123 =56,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,            # 第一个集合的大小
area2 = 319,            # 第二个集合的大小
area3 = 335,            # 第三个集合的大小
n12 = 113,              # 集合 1 和 集合 2 的交集大小
n13 = 174,              # 集合 1 和 集合 3 的交集大小
n23 = 160,              # 集合 2 和 集合 3 的交集大小
n123 =56,             # 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,  # 第一个集合的大小
area2 = 319,  # 第二个集合的大小
area3 = 419,  # 第三个集合的大小
n12 = 113,  # 集合 1 和 集合 2 的交集大小
n13 = 140,  # 集合 1 和 集合 3 的交集大小
n23 = 135,  # 集合 2 和 集合 3 的交集大小
n123 = 45,  # 三个集合的交集大小
# 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 加载 VennDiagram 包
library(extrafont)
library(VennDiagram)
# 创建三个集合的维恩图，定义集合及其交集的大小
venn.plot <- draw.triple.venn(
area1 = 924,  # 第一个集合的大小
area2 = 319,  # 第二个集合的大小
area3 = 419,  # 第三个集合的大小
n12 = 113,  # 集合 1 和 集合 2 的交集大小
n13 = 140,  # 集合 1 和 集合 3 的交集大小
n23 = 135,  # 集合 2 和 集合 3 的交集大小
n123 = 45,  # 三个集合的交集大小
# 集合 1、2 和 3 的交集大小
category = c("Insulation score", "DI", "Predict"),  # 集合名称
fill = c("skyblue", "pink", "lightgreen"),  # 填充颜色
lty = "blank",          # 不显示边框线
cex = 2,                # 标签文字大小
cat.cex = 2,            # 类别名称文字大小
cat.pos = c(-20, 25, 180), # 类别名称的位置
cat.dist = c(0.05, 0.05, 0.05), # 类别名称距离圆圈的距离
fontfamily = "Times New Roman"
)
# 将维恩图绘制到绘图设备中
grid.draw(venn.plot)
library(ggplot2)
ggsave("my_plot.pdf", plot = venn.plot, width = 6, height = 6)
# 手动输入数据（示例数据）
data <- data.frame(
Bk = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
C = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
S = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
Pt = c(1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3),
Tree = c(1, 1, 1, 2, 2, 1, 2, 3, 3, 2, 2, 3),
A = c(8, 12, 8, 12, 16, 8, 12, 8, 16, 12, 16, 20),
H = c(9.64, 11.45, 8.12, 11.02, 12.87, 8.15, 10.7, 10.02, 11.13, 10.66, 13.06, 13.81)
)
# 保存为 CSV 文件
write.csv(data, "height_data.csv", row.names = FALSE)
# 手动输入数据（示例数据）
data <- data.frame(
Bk = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
C = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
S = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
Pt = c(1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3),
Tree = c(1, 1, 1, 2, 2, 1, 2, 3, 3, 2, 2, 3),
A = c(8, 12, 8, 12, 16, 8, 12, 8, 16, 12, 16, 20),
H = c(9.64, 11.45, 8.12, 11.02, 12.87, 8.15, 10.7, 10.02, 11.13, 10.66, 13.06, 13.81)
)
# 保存为 CSV 文件
write.csv(data, "/Users/zhongjiaxin/Downloads/chap10/height_data.csv", row.names = FALSE)
setwd('/Users/zhongjiaxin/Downloads/chap10')
data = read.csv("data10_2.csv")
# 使用 nlme 构建混合效应模型 height_model
height_model = nlme(
model = H ~ phi1 + phi2 * exp(-phi3 / A),  # 模型公式
data = data,                               # 数据集
fixed = list(phi2 ~ 1, phi3 ~ C),          # 设置 phi2 和 phi3 的固定效应，其中 phi3 随 C 变化
random = list(Bk = phi1 ~ 1),              # phi1 的随机效应项，按 Bk 分组
start = c(phi2 = 15.087, phi3 = c(12.734, 12.734)) # 初始值
)
library(nlme)
height_model = nlme(
model = H ~ phi1 + phi2 * exp(-phi3 / A),  # 模型公式
data = data,                               # 数据集
fixed = list(phi2 ~ 1, phi3 ~ C),          # 设置 phi2 和 phi3 的固定效应，其中 phi3 随 C 变化
random = list(Bk = phi1 ~ 1),              # phi1 的随机效应项，按 Bk 分组
start = c(phi2 = 15.087, phi3 = c(12.734, 12.734)) # 初始值
)
data
data$Bk
# 将数据直接输入为数据框
data <- data.frame(
Bk = c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2),
C = c(1,1,0,0,1,1,0,1,1,1,0,0,1,0,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1,0,0,1),
S = c(1,1,1,1,2,2,1,1,2,2,1,1,2,2,2,1,1,2,2,2,1,1,2,1,1,1,2,2,1,2,2,1),
Pt = c(1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,2,1,1,1,2,1,1,1,1,2,2,2,1),
Tree = c(1,1,1,1,2,2,1,2,2,2,3,3,3,3,3,3,3,3,3,3,1,1,1,1,2,2,2,2,2,2,2,2),
A = c(8,12,8,12,16,8,8,12,16,20,8,12,16,20,8,12,16,20,8,12,8,12,16,8,12,8,8,12,12,16,16,20),
H = c(9.64,11.45,8.12,11.02,12.87,10.72,8.15,10.66,13.06,13.38,7.27,10.53,11.73,12.92,8.47,10.72,12.05,13.83,10.27,11.56,7.99,10.27,11.06,7.89,10.52,8.02,10.45,11.26,12.87,13.18,12.53,11.97)
)
# 将数据保存为 CSV 文件
write.csv(data, "/Users/zhongjiaxin/Downloads/chap10/data10_2.csv", row.names = FALSE)
data = read.csv("data10_2.csv")
# 使用 nlme 构建混合效应模型 height_model
library(nlme)
data
height_model = nlme(
model = H ~ phi1 + phi2 * exp(-phi3 / A),  # 模型公式
data = data,                               # 数据集
fixed = list(phi2 ~ 1, phi3 ~ C),          # 设置 phi2 和 phi3 的固定效应，其中 phi3 随 C 变化
random = list(Bk = phi1 ~ 1),              # phi1 的随机效应项，按 Bk 分组
start = c(phi2 = 15.087, phi3 = c(12.734, 12.734)) # 初始值
)
summary(height_model)
data = read.csv("data10_2.csv")
# 使用 nlme 构建混合效应模型 height_model
library(nlme)
height_model = nlme(
model = H ~ phi1 + phi2 * exp(-phi3 / A),  # 模型公式
data = data,                               # 数据集
fixed = list(phi2 ~ 1, phi3 ~ C),          # 设置 phi2 和 phi3 的固定效应，其中 phi3 随 C 变化
random = list(Bk = phi1 ~ 1),              # phi1 的随机效应项，按 Bk 分组
start = c(phi2 = 15.087, phi3 = c(12.734, 12.734)) # 初始值
)
# 输出模型汇总信息
summary(height_model)
# 提取模型的随机效应
ranef(height_model)
length(data)
length(data[1])
data
